machine:
#  environment:
#    GCLOUD_PROJECT: gophish-150317
#    GCLOUD_CLUSTER_NAME: gophish-cluster
#    GCLOUD_COMPUTE_ZONE: asia-east1-a
  services:
    - docker

#dependencies:
#    pre:
#        - sudo /opt/google-cloud-sdk/bin/gcloud --quiet components update
#        - sudo /opt/google-cloud-sdk/bin/gcloud --quiet components update kubectl
#        - echo $GCLOUD_SERVICE_KEY | base64 --decode > ${HOME}/gcloud-service-key.json
#        - sudo /opt/google-cloud-sdk/bin/gcloud auth activate-service-account --key-file ${HOME}/gcloud-service-key.json
#        - sudo /opt/google-cloud-sdk/bin/gcloud config set project $GCLOUD_PROJECT
#        - sudo /opt/google-cloud-sdk/bin/gcloud config set compute/zone ${GCLOUD_COMPUTE_ZONE}
#        - sudo /opt/google-cloud-sdk/bin/gcloud --quiet container clusters get-credential $iGCLOUD_CLUSTER_NAME
#        - docker build --rm=false -t asia.gcr.io/${GCLOUD_PROJECT}/gophish:$CIRCLE_SHA1 .
#        - docker tag asia.gcr.io/${GCLOUD_PROJECT}/gophish:$CIRCLE_SHA1 asia.gcr.io/${GCLOUD_PROJECT}/gophish:latest
#        - docker info
#test:
#    post:
#        - docker run -d -p 3000:3000 --name gophish asia.gcr.io/gophish-150317/gophish:latest; sleep 10
#        - curl http://localhost:3000 -v

#deployment:
#    release:
#        tag: /v[0-9]+(\.[0-9]+)*/
#        commands: #とりあえずprodと同じcommandsに設定
#            - sudo /opt/google-cloud-sdk/bin/gcloud docker push asia.gcr.io/${GCLOUD_PROJECT}/gophish:latest
#    prod:
#        branch: master
#        commands:
#            - sudo /opt/google-cloud-sdk/bin/gcloud docker push asia.gcr.io/${GCLOUD_PROJECT}/gophish:latest
